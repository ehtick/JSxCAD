import { fill } from './fill.js';
import { initCgal } from './getCgal.js';

import test from 'ava';

test.beforeEach(async (t) => {
  await initCgal();
});

/*
test('Fill Segments', (t) => {
  const filled = fill([
    {
      type: 'segments',
      segments: [
  [
    [1.02, -0.83, 0.0],
    [-1.09, -0.72, 0.0],
  ],
  [
    [-0.8, -1.03, 0.0],
    [-0.75, 0.9, 0.0],
  ],
  [
    [-1.15, 0.39, 0.0],
    [1.34, 0.37, 0.0],
  ],
  [
    [0.51, 0.97, 0.0],
    [0.72, -1.31, 0.0],
  ],
  [
    [0.4, -0.52, 0.0],
    [-0.53, -0.47, 0.0],
  ],
  [
    [-0.4, -0.59, 0.0],
    [-0.41, 0.14, -0.0],
  ],
  [
    [-0.5, -0.04, -0.0],
    [0.35, 0.0, -0.0],
  ],
  [
    [0.18, 0.11, 0.0],
    [0.22, -0.64, 0.0],
  ],
] }]);
  t.deepEqual(JSON.parse(JSON.stringify(filled)), []);
});
*/

test('Fill', (t) => {
  const filled = fill([
    {
      type: 'polygonsWithHoles',
      polygonsWithHoles: [
        {
          points: [
            [-0.8660254037844385, -0.5000000000000003],
            [0.8660254037844387, -0.49999999999999983],
            [6.123233995736766e-17, 1],
          ],
          exactPoints: [
            [
              '-7800463371553961/9007199254740992',
              '-4503599627370499/9007199254740992',
            ],
            [
              '7800463371553963/9007199254740992',
              '-9007199254740989/18014398509481984',
            ],
            ['4967757600021511/81129638414606681695789005144064', '1'],
          ],
          holes: [],
        },
      ],
      plane: [0, 0, 1, 0],
      exactPlane: ['0', '0', '1', '0'],
      matrix: [
        1,
        0,
        0,
        0,
        0,
        1,
        0,
        0,
        0,
        0,
        1,
        0,
        0,
        0,
        0,
        1,
        '1',
        '0',
        '0',
        '0',
        '0',
        '1',
        '0',
        '0',
        '0',
        '0',
        '1',
        '0',
        '1',
      ],
      tags: [],
    },
    {
      type: 'polygonsWithHoles',
      polygonsWithHoles: [
        {
          points: [
            [-0.8660254037844385, -0.5000000000000003],
            [0.8660254037844387, -0.49999999999999983],
            [6.123233995736766e-17, 1],
          ],
          exactPoints: [
            [
              '-7800463371553961/9007199254740992',
              '-4503599627370499/9007199254740992',
            ],
            [
              '7800463371553963/9007199254740992',
              '-9007199254740989/18014398509481984',
            ],
            ['4967757600021511/81129638414606681695789005144064', '1'],
          ],
          holes: [],
        },
      ],
      plane: [0, 0, 1, 0],
      exactPlane: ['0', '0', '1', '0'],
      matrix: [
        0.5,
        0,
        0,
        0,
        0,
        0.5,
        0,
        0,
        0,
        0,
        0.5,
        0,
        0,
        0,
        0,
        1,
        '1/2',
        '0',
        '0',
        '0',
        '0',
        '1/2',
        '0',
        '0',
        '0',
        '0',
        '1/2',
        '0',
        '1',
      ],
      tags: [],
    },
  ]);
  t.deepEqual(JSON.parse(JSON.stringify(filled)), [
    {
      type: 'polygonsWithHoles',
      polygonsWithHoles: [
        {
          points: [
            [6.123233995736766e-17, 1],
            [-0.8660254037844385, -0.5000000000000003],
            [0.8660254037844387, -0.49999999999999983],
          ],
          exactPoints: [
            ['4967757600021511/81129638414606681695789005144064', '1'],
            [
              '-7800463371553961/9007199254740992',
              '-4503599627370499/9007199254740992',
            ],
            [
              '7800463371553963/9007199254740992',
              '-9007199254740989/18014398509481984',
            ],
          ],
          holes: [
            {
              points: [
                [-0.43301270189221924, -0.25000000000000017],
                [3.061616997868383e-17, 0.5],
                [0.43301270189221935, -0.24999999999999992],
              ],
              exactPoints: [
                [
                  '-7800463371553961/18014398509481984',
                  '-4503599627370499/18014398509481984',
                ],
                ['4967757600021511/162259276829213363391578010288128', '1/2'],
                [
                  '7800463371553963/18014398509481984',
                  '-9007199254740989/36028797018963968',
                ],
              ],
              holes: [],
            },
          ],
        },
      ],
      plane: [0, 0, 1, 0],
      exactPlane: ['0', '0', '1', '0'],
      matrix: [
        1,
        0,
        0,
        0,
        0,
        1,
        0,
        0,
        0,
        0,
        1,
        0,
        0,
        0,
        0,
        1,
        '1',
        '0',
        '0',
        '0',
        '0',
        '1',
        '0',
        '0',
        '0',
        '0',
        '1',
        '0',
        '1',
      ],
      tags: [],
    },
  ]);
});
